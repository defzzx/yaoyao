<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>tast5</title>
<style type="text/css">
table {
	border-collapse: collapse;
}
td {
	width: 40px;
	height: 40px;
	border: 1px solid #ccc;
	box-sizing: border-box;
	text-align: center;
	padding: 0;
}
table tr:first-child td {
	border: none;
	font-size: 15px;
	font-weight: 700;
	border-bottom: 2px solid #666;
}
table tr:first-child td:first-child {
	border: none;
}
table tr>td:last-child {
	border-right: 2px solid #666;
}
table tr:first-child td:last-child {
	border-right: none;
}
table tr:last-child td {
	border-bottom: 2px solid #666;
}
table tr td:first-child {
	border: none;
	font-size: 15px;
	font-weight: 700;
	border-right: 2px solid #666;
}
#wrapani {
	position: relative;
}
#ani {
	display: block;
	width: 39px;
	height: 39px;
	background: #00f;
	font-size: 10px;
	position: absolute;
	bottom: 0;
	right: 0;
	transition: all 1s;
}
#ani i {
	display: inline-block;
	background: #f00;
	width: 39px;
}
</style>
</head>
<body>
<table>
	<tr>
		<td></td>
		<td>1</td>
		<td>2</td>
		<td>3</td>
		<td>4</td>
		<td>5</td>
		<td>6</td>
		<td>7</td>
		<td>8</td>
		<td>9</td>
		<td>10</td>
	</tr>
	<tr>
		<td>1</td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>2</td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>3</td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>4</td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>5</td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td id="wrapani"><span id="ani"><i>我是头</i></span></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>6</td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>7</td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>8</td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>9</td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>10</td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<input type="text" name="go" id="go" />
<button>执行</button>

<script type="text/javascript">
var btn = document.getElementsByTagName('button')[0];
var ani = document.getElementById("ani");
var step = 90,
	num = 0,
	n = 0,
	x = 0,
	y = 0,
	animation = false;
btn.addEventListener('click', fn, false);

function fn() {
	if(animation == true) {
		return false;
	}
	animation = true;
	var txt = document.getElementById('go').value.toUpperCase();
	console.log(txt)
	if(txt == 'TUN LEF') {
		tLeft();
		tm()
	} else if(txt == 'TUN RIG') {
		tRight();
		tm()
	} else if(txt == 'TUN BAC') {
		tBac();
		tm()
	} else if(txt == 'TRA LEF') {
		gLeft();
		tm()
	} else if(txt == 'TRA TOP') {
		gTop();
		tm()
	} else if(txt == 'TRA RIG') {
		gRight();
		tm()
	} else if(txt == 'TRA BOT') {
		gBottom();
		tm()
	} else if(txt == 'MOV LEF') {
		switch(num) {
			case 0:
				sb();
				tLeft();
				setTimeout(gLeft, 1000)
				break;
			case -1:
			case 3:
				tm();
				gLeft()
				break;
			case -2:
			case 2:
				sb();
				tRight();
				setTimeout(gLeft, 1000)
				break;
			case -3:
			case 1:
				sb();
				tBac();
				setTimeout(gLeft, 1000)
				break;
		}
	} else if(txt == 'MOV TOP') {
		switch(num) {
			case 0:
				tm();
				gTop()
				break;
			case -1:
			case 3:
				sb();
				tRight();
				setTimeout(gTop, 1000)
				break;
			case -2:
			case 2:
				sb();
				tBac();
				setTimeout(gTop, 1000)
				break;
			case -3:
			case 1:
				sb();
				tLeft()
				setTimeout(gTop, 1000)
				break;
		}
	} else if(txt == 'MOV RIG') {
		switch(num) {
			case 0:
				sb();
				tRight();
				setTimeout(gRight, 1000)
				break;
			case -1:
			case 3:
				sb();
				tBac();
				setTimeout(gRight, 1000)
				break;
			case -2:
			case 2:
				sb();
				tLeft();
				setTimeout(gRight, 1000)
				break;
			case -3:
			case 1:
				tm();
				gRight();
				break;
		}
	} else if(txt == 'MOV BOT') {
		switch(num) {
			case 0:
				sb();
				tBac();
				setTimeout(gBottom, 1000)
				break;
			case -1:
			case 3:
				sb();
				tLeft();
				setTimeout(gBottom, 1000)
				break;
			case -2:
			case 2:
				tm();
				gBottom();
				break;
			case -3:
			case 1:
				sb();
				tRight();
				setTimeout(gBottom, 1000)
				break;
		}
	} else if(txt == 'GO') {
		switch(num) {
			case 0:
				gTop();
				break;
			case -1:
			case 3:
				gLeft();
				break;
			case -2:
			case 2:
				gBottom();
				break;
			case -3:
			case 1:
				gRight();
				break;
		}
		tm();
	} else {
		alert('错误指令!')
	}

	function tLeft() {
		num--;
		go(step * --n);
		if(num == -4) {
			num = 0;
		}
	}

	function tRight() {
		num++;
		go(step * ++n);
		if(num == 4) {
			num = 0;
		}
	}

	function tBac() {
		go(step * (n += 2));
		num += 2;
		if(Math.abs(num) == 4) {
			num = 0;
		} else if(num == 5) {
			num = 1;
		} else if(num == -5) {
			num = -1;
		}
	}

	function gLeft() {
		if(x > 120) {
			alert('撞墙啦!');
			return false;
		}
		x += 40;
		ani.style.right = x + 'px';
	}

	function gRight() {
		if(x < -160) {
			alert('撞墙啦!');
			return false;
		}
		x -= 40;
		ani.style.right = x + 'px';
	}

	function gTop() {
		if(y > 120) {
			alert('撞墙啦!');
			return false;
		}
		y += 40;
		ani.style.bottom = y + 'px';
	}

	function gBottom() {
		if(y < -160) {
			alert('撞墙啦!');
			return false;
		}
		y -= 40;
		ani.style.bottom = y + 'px';
	}

	function go(iTarget) {
		ani.style.transform = 'rotate(' + iTarget + 'deg)';
	}

	function tm() {
		setTimeout(function() { animation = false }, 1000)
	}

	function sb() {
		setTimeout(function() { animation = false }, 2000)
	}
}
</script>
</body>
</html>